"""
CALCULADORA COMPLETA EM PYTHON
Com coment√°rios explicativos em cada linha
"""

# Importa o m√≥dulo 'math' para opera√ß√µes matem√°ticas avan√ßadas
import math


def calculadora():
    """
    Fun√ß√£o principal da calculadora.
    Controla o menu e direciona para as opera√ß√µes.
    """

    # Loop infinito para manter a calculadora rodando
    while True:
        # Exibe o menu de op√ß√µes
        print("\n" + "=" * 40)  # Imprime 40 sinais de "=" para separa√ß√£o
        print("CALCULADORA PYTHON - ESCOLHA A OPERA√á√ÉO")
        print("=" * 40)
        print("1. Soma (+)")
        print("2. Subtra√ß√£o (-)")
        print("3. Multiplica√ß√£o (*)")
        print("4. Divis√£o (/)")
        print("5. Pot√™ncia (x ∏)")
        print("6. Raiz Quadrada (‚àö)")
        print("7. Porcentagem (%)")
        print("8. Sair")
        print("-" * 40)

        # Solicita ao usu√°rio que escolha uma op√ß√£o
        # input() sempre retorna string, ent√£o vamos usar como est√°
        opcao = input("Digite o n√∫mero da opera√ß√£o (1-8): ")

        # Verifica se o usu√°rio quer sair (op√ß√£o 8)
        if opcao == "8":
            print("Obrigado por usar a calculadora! At√© mais! üëã")
            break  # Sai do loop while e encerra a fun√ß√£o

        # Se n√£o for sair, verifica se a op√ß√£o √© v√°lida (1-7)
        if opcao not in ["1", "2", "3", "4", "5", "6", "7"]:
            print("‚ùå Op√ß√£o inv√°lida! Tente novamente.")
            continue  # Volta para o in√≠cio do loop

        # OPERA√á√ïES QUE PRECISAM DE DOIS N√öMEROS
        if opcao in ["1", "2", "3", "4", "5", "7"]:
            try:
                # Solicita o primeiro n√∫mero
                # float() converte a string para n√∫mero decimal
                num1 = float(input("Digite o primeiro n√∫mero: "))

                # Solicita o segundo n√∫mero
                num2 = float(input("Digite o segundo n√∫mero: "))

                # Chama a fun√ß√£o para realizar a opera√ß√£o escolhida
                realizar_operacao(opcao, num1, num2)

            except ValueError:  # Captura erro se usu√°rio digitar texto em vez de n√∫mero
                print("‚ùå Erro: Digite apenas n√∫meros v√°lidos!")
            except ZeroDivisionError:  # Captura erro de divis√£o por zero
                print("‚ùå Erro: N√£o √© poss√≠vel dividir por zero!")

        # OPERA√á√ÉO DE RAIZ QUADRADA (precisa de apenas um n√∫mero)
        elif opcao == "6":
            try:
                # Solicita o n√∫mero para calcular a raiz
                num = float(input("Digite o n√∫mero para calcular a raiz quadrada: "))

                # Verifica se o n√∫mero √© negativo (raiz de negativo d√° erro com math.sqrt)
                if num < 0:
                    print("‚ùå Erro: N√£o √© poss√≠vel calcular raiz de n√∫mero negativo!")
                else:
                    # Calcula a raiz quadrada usando math.sqrt()
                    resultado = math.sqrt(num)
                    print(f"‚àö{num} = {resultado:.4f}")  # :.4f formata com 4 casas decimais

            except ValueError:
                print("‚ùå Erro: Digite um n√∫mero v√°lido!")


def realizar_operacao(opcao, num1, num2):
    """
    Executa a opera√ß√£o matem√°tica baseada na op√ß√£o escolhida.

    Par√¢metros:
    opcao (str): N√∫mero da opera√ß√£o escolhida
    num1 (float): Primeiro n√∫mero
    num2 (float): Segundo n√∫mero
    """

    # Dicion√°rio com s√≠mbolos das opera√ß√µes para exibi√ß√£o
    simbolos = {
        "1": "+",
        "2": "-",
        "3": "*",
        "4": "/",
        "5": "^",
        "7": "%"
    }

    # Obt√©m o s√≠mbolo da opera√ß√£o atual
    simbolo = simbolos[opcao]

    # Executa a opera√ß√£o correspondente √† op√ß√£o escolhida
    if opcao == "1":  # SOMA
        resultado = num1 + num2

    elif opcao == "2":  # SUBTRA√á√ÉO
        resultado = num1 - num2

    elif opcao == "3":  # MULTIPLICA√á√ÉO
        resultado = num1 * num2

    elif opcao == "4":  # DIVIS√ÉO
        # Verifica se est√° tentando dividir por zero
        if num2 == 0:
            print("‚ùå Erro: Divis√£o por zero n√£o √© permitida!")
            return  # Sai da fun√ß√£o sem mostrar resultado
        resultado = num1 / num2

    elif opcao == "5":  # POT√äNCIA
        resultado = num1 ** num2  # ** √© o operador de pot√™ncia

    elif opcao == "7":  # PORCENTAGEM
        # Calcula porcentagem: (num1 * num2) / 100
        resultado = (num1 * num2) / 100

    # Formata o resultado para exibi√ß√£o
    # Verifica se o resultado √© inteiro para n√£o mostrar .0 desnecessariamente
    if resultado == int(resultado):
        resultado_formatado = int(resultado)
    else:
        resultado_formatado = round(resultado, 4)  # Arredonda para 4 casas decimais

    # Exibe o resultado da opera√ß√£o
    print(f"\nüî¢ RESULTADO: {num1} {simbolo} {num2} = {resultado_formatado}")


def historico_calculos():
    """
    Vers√£o avan√ßada da calculadora com hist√≥rico.
    Demonstra mais recursos do Python.
    """

    # Lista para armazenar o hist√≥rico de c√°lculos
    historico = []

    print("\n" + "=" * 50)
    print("CALCULADORA COM HIST√ìRICO")
    print("=" * 50)

    while True:
        print("\nMENU:")
        print("1. Novo c√°lculo")
        print("2. Ver hist√≥rico")
        print("3. Limpar hist√≥rico")
        print("4. Voltar")

        escolha = input("Escolha: ")

        if escolha == "1":
            # Solicita a express√£o matem√°tica do usu√°rio
            expressao = input("Digite a express√£o (ex: 10 + 5): ")

            try:
                # AVISO DE SEGURAN√áA: eval() pode ser perigoso em produ√ß√£o
                # Aqui estamos usando apenas para demonstra√ß√£o educacional
                resultado = eval(expressao)  # eval() calcula a express√£o

                # Adiciona ao hist√≥rico como um dicion√°rio
                calculo = {
                    "expressao": expressao,
                    "resultado": resultado,
                    "data": "hoje"  # Em vers√£o real, usar datetime.now()
                }
                historico.append(calculo)

                print(f"‚úÖ Resultado: {resultado}")

            except Exception as e:
                print(f"‚ùå Erro na express√£o: {e}")

        elif escolha == "2":
            if not historico:  # Verifica se o hist√≥rico est√° vazio
                print("üì≠ Hist√≥rico vazio")
            else:
                print("\nüìã HIST√ìRICO DE C√ÅLCULOS:")
                # Percorre o hist√≥rico com enumerate para ter √≠ndice
                for i, calc in enumerate(historico, 1):
                    print(f"{i}. {calc['expressao']} = {calc['resultado']}")

        elif escolha == "3":
            historico.clear()  # Limpa toda a lista
            print("üóëÔ∏è Hist√≥rico limpo!")

        elif escolha == "4":
            break  # Sai do loop e retorna

        else:
            print("‚ùå Op√ß√£o inv√°lida!")


def calculadora_avancada():
    """
    Demonstra opera√ß√µes matem√°ticas avan√ßadas.
    """

    print("\n" + "=" * 50)
    print("FUN√á√ïES MATEM√ÅTICAS AVAN√áADAS")
    print("=" * 50)

    while True:
        print("\nOpera√ß√µes Avan√ßadas:")
        print("1. Seno (sin)")
        print("2. Cosseno (cos)")
        print("3. Tangente (tan)")
        print("4. Logaritmo natural (ln)")
        print("5. Fatorial (!)")
        print("6. Voltar")

        opcao = input("Escolha: ")

        if opcao == "6":
            break

        if opcao in ["1", "2", "3", "4"]:
            try:
                # Converte para radianos (fun√ß√µes trigonom√©tricas usam radianos)
                angulo = float(input("√Çngulo em graus: "))
                radianos = math.radians(angulo)  # Converte graus para radianos

                if opcao == "1":  # SENO
                    resultado = math.sin(radianos)
                    print(f"sin({angulo}¬∞) = {resultado:.4f}")

                elif opcao == "2":  # COSSENO
                    resultado = math.cos(radianos)
                    print(f"cos({angulo}¬∞) = {resultado:.4f}")

                elif opcao == "3":  # TANGENTE
                    # Verifica √¢ngulos onde tangente n√£o existe (90¬∞, 270¬∞, etc.)
                    if angulo % 180 == 90:
                        print("‚ùå Tangente n√£o definida para este √¢ngulo!")
                    else:
                        resultado = math.tan(radianos)
                        print(f"tan({angulo}¬∞) = {resultado:.4f}")

                elif opcao == "4":  # LOGARITMO NATURAL
                    num = float(input("N√∫mero para ln: "))
                    if num <= 0:
                        print("‚ùå ln s√≥ existe para n√∫meros positivos!")
                    else:
                        resultado = math.log(num)
                        print(f"ln({num}) = {resultado:.4f}")

            except ValueError:
                print("‚ùå Valor inv√°lido!")

        elif opcao == "5":  # FATORIAL
            try:
                num = int(input("N√∫mero para fatorial: "))
                if num < 0:
                    print("‚ùå Fatorial n√£o existe para n√∫meros negativos!")
                elif num > 20:  # Limita para n√£o travar o PC
                    print("‚ö†Ô∏è  N√∫mero muito grande! Use um menor que 20.")
                else:
                    resultado = math.factorial(num)
                    print(f"{num}! = {resultado}")
            except ValueError:
                print("‚ùå Digite um n√∫mero inteiro!")


# MENU PRINCIPAL DO PROGRAMA
if __name__ == "__main__":
    """
    Ponto de entrada do programa.
    Esta condi√ß√£o verifica se o arquivo est√° sendo executado diretamente
    (n√£o importado como m√≥dulo).
    """

    print("üåü BEM-VINDO √Ä SUPER CALCULADORA PYTHON üåü")

    while True:
        print("\n" + "=" * 50)
        print("MENU PRINCIPAL")
        print("=" * 50)
        print("1. Calculadora B√°sica")
        print("2. Calculadora com Hist√≥rico")
        print("3. Fun√ß√µes Avan√ßadas")
        print("4. Sair do Programa")
        print("-" * 50)

        modo = input("Escolha o modo (1-4): ")

        if modo == "1":
            calculadora()  # Chama a calculadora b√°sica

        elif modo == "2":
            historico_calculos()  # Chama a vers√£o com hist√≥rico

        elif modo == "3":
            calculadora_avancada()  # Chama as fun√ß√µes avan√ßadas

        elif modo == "4":
            print("\n‚ú® Obrigado por usar a Super Calculadora Python! ‚ú®")
            break  # Encerra o programa

        else:
            print("‚ùå Op√ß√£o inv√°lida! Escolha 1, 2, 3 ou 4.")
